---
/**
 * Pages for Craft's "Example Channel" section
 */

import type { GetStaticPaths } from 'astro';
import fetchAPI from '@lib/craft-cms/fetch-api';
import staticPaths from '@lib/craft-cms/static-paths';

/**
 * `Props` interface is tied to Astro.props
 * https://docs.astro.build/en/guides/typescript/#component-props
 */
interface Props {
  entry: Entry;
}

interface Entry {
  title: string;
  uri: string;
}

interface Data {
  entries: Entry[];
}

export const getStaticPaths = (async () => {
  const data = await fetchAPI<Data>(`{
    entries (section: "exampleChannel") {
      title
      uri
      url
    }
  }`);

  return await staticPaths<Entry>({
    entries: data?.entries,
    uriPrefix: 'example-channel',
  });
}) satisfies GetStaticPaths;

const { entry } = Astro.props;
---

{entry.title}
